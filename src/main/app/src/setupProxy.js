// This file is used by react-scripts to customize webpack-dev-server proxy
// https://create-react-app.dev/docs/proxying-api-requests-in-development
const { createProxyMiddleware } = require('http-proxy-middleware');
const {
  DEV_VIRKAILIJA_URL,
  DISABLE_LOCAL_PROXY,
  KOUTA_BACKEND_URL,
} = process.env;

const createKoutaProxyMiddleware = (targetUrl, overrides) =>
  createProxyMiddleware({
    autoRewrite: true,
    headers: {
      'Access-Control-Allow-Origin': targetUrl,
    },
    changeOrigin: true,
    cookieDomainRewrite: 'localhost',
    secure: false,
    target: targetUrl,
    ...overrides,
  });

const CAS_URL = 'http://localhost:3004';

const devProxyMiddleware = createKoutaProxyMiddleware(DEV_VIRKAILIJA_URL);

const koutaBackendProxyMiddleware =
  KOUTA_BACKEND_URL && createKoutaProxyMiddleware(KOUTA_BACKEND_URL);

const casProxyMiddleware = createKoutaProxyMiddleware(CAS_URL);

const ohjausparametritFixture = {
  timestamp: 1607372388291,
  user: '1.2.246.562.24.26603962037',
  contextPath: '/ohjausparametrit-service',
  checks: {
    database: {
      url:
        'jdbc:postgresql://ohjausparametrit.db.hahtuvaopintopolku.fi:5432/ohjausparametrit?prepareThreshold\u003d5\u0026preparedStatementCacheQueries\u003d256\u0026preparedStatementCacheSizeMiB\u003d5\u0026databaseMetadataCacheFields\u003d65536\u0026databaseMetadataCacheFieldsMiB\u003d5\u0026defaultRowFetchSize\u003d0\u0026binaryTransfer\u003dtrue\u0026readOnly\u003dfalse\u0026binaryTransferEnable\u003d\u0026binaryTransferDisable\u003d\u0026unknownLength\u003d2147483647\u0026logUnclosedConnections\u003dfalse\u0026disableColumnSanitiser\u003dfalse\u0026tcpKeepAlive\u003dfalse\u0026loginTimeout\u003d10\u0026connectTimeout\u003d10\u0026socketTimeout\u003d0\u0026cancelSignalTimeout\u003d10\u0026receiveBufferSize\u003d-1\u0026sendBufferSize\u003d-1\u0026ApplicationName\u003dohjausparametrit-service\u0026jaasLogin\u003dtrue\u0026useSpnego\u003dfalse\u0026gsslib\u003dauto\u0026sspiServiceClass\u003dPOSTGRES\u0026allowEncodingChanges\u003dfalse\u0026targetServerType\u003dany\u0026loadBalanceHosts\u003dfalse\u0026hostRecheckSeconds\u003d10\u0026preferQueryMode\u003dextended\u0026autosave\u003dnever\u0026reWriteBatchedInserts\u003dfalse',
      counts: {
        act_hi_comment: 0,
        act_re_deployment: 3,
        act_ge_property: 3,
        act_ru_event_subscr: 0,
        act_ru_variable: 60,
        schema_version: 2,
        act_id_membership: 0,
        act_re_procdef: 4,
        act_hi_procinst: 7309,
        parameter: 11710,
        act_hi_attachment: 0,
        act_evt_log: 0,
        act_hi_varinst: 21864,
        act_ru_identitylink: 0,
        act_id_group: 0,
        act_hi_detail: 0,
        act_hi_taskinst: 7288,
        act_id_user: 0,
        act_ru_job: 21,
        act_ru_task: 20,
        act_hi_actinst: 28532,
        act_hi_identitylink: 0,
        act_ru_execution: 40,
        act_ge_bytearray: 6,
        act_re_model: 0,
        act_id_info: 0,
      },
    },
    buildversion: {
      buildTtime: '2020-07-15T07:51:20Z',
      branchName: 'master',
      artifactId: 'ohjausparametrit-service',
      buildNumber: 'org.apache.maven.model.Build@53d1b9b3',
      version: '9.5-SNAPSHOT',
      vcsRevision: 'ce8ec55549fb26f27619602503cf017e527d5d54',
    },
    foo: 'OK',
  },
  status: 'OK',
};

const kayttooikeusMeFixture = {
  uid: 'testuser',
  oid: '1.2.246.562.24.26603962037',
  firstName: 'Test',
  lastName: 'User',
  groups: [
    'APP_ASIAKIRJAPALVELU',
    'APP_ASIAKIRJAPALVELU_ASIOINTITILICRUD',
    'APP_ASIAKIRJAPALVELU_ASIOINTITILICRUD_1.2.246.562.10.00000000001',
    'APP_ASIAKIRJAPALVELU_CREATE_LETTER',
    'APP_ASIAKIRJAPALVELU_CREATE_LETTER_1.2.246.562.10.00000000001',
    'APP_ASIAKIRJAPALVELU_CREATE_TEMPLATE',
    'APP_ASIAKIRJAPALVELU_CREATE_TEMPLATE_1.2.246.562.10.00000000001',
    'APP_ASIAKIRJAPALVELU_READ',
    'APP_ASIAKIRJAPALVELU_READ_1.2.246.562.10.00000000001',
    'APP_ASIAKIRJAPALVELU_SEND_LETTER_EMAIL',
    'APP_ASIAKIRJAPALVELU_SEND_LETTER_EMAIL_1.2.246.562.10.00000000001',
    'APP_ASIAKIRJAPALVELU_SYSTEM_ATTACHMENT_DOWNLOAD',
    'APP_ASIAKIRJAPALVELU_SYSTEM_ATTACHMENT_DOWNLOAD_1.2.246.562.10.00000000001',
    'APP_ATARU_EDITORI',
    'APP_ATARU_EDITORI_CRUD',
    'APP_ATARU_EDITORI_CRUD_1.2.246.562.10.00000000001',
    'APP_ATARU_HAKEMUS',
    'APP_ATARU_HAKEMUS_CRUD',
    'APP_ATARU_HAKEMUS_CRUD_1.2.246.562.10.00000000001',
    'APP_ATARU_HAKEMUS_VALINTA_CRUD',
    'APP_ATARU_HAKEMUS_VALINTA_CRUD_1.2.246.562.10.00000000001',
    'APP_EPERUSTEET',
    'APP_EPERUSTEET_AMOSAA',
    'APP_EPERUSTEET_AMOSAA_ADMIN',
    'APP_EPERUSTEET_AMOSAA_ADMIN_1.2.246.562.10.00000000001',
    'APP_EPERUSTEET_AMOSAA_CRUD',
    'APP_EPERUSTEET_AMOSAA_CRUD_1.2.246.562.10.00000000001',
    'APP_EPERUSTEET_CRUD',
    'APP_EPERUSTEET_CRUD_1.2.246.562.10.00000000001',
    'APP_EPERUSTEET_YLOPS',
    'APP_EPERUSTEET_YLOPS_ADMIN',
    'APP_EPERUSTEET_YLOPS_ADMIN_1.2.246.562.10.00000000001',
    'APP_EPERUSTEET_YLOPS_CRUD',
    'APP_EPERUSTEET_YLOPS_CRUD_1.2.246.562.10.00000000001',
    'APP_HAKEMUS',
    'APP_HAKEMUS_CRUD',
    'APP_HAKEMUS_CRUD_1.2.246.562.10.00000000001',
    'APP_HAKUJENHALLINTA',
    'APP_HAKUJENHALLINTA_CRUD',
    'APP_HAKUJENHALLINTA_CRUD_1.2.246.562.10.00000000001',
    'APP_HAKULOMAKKEENHALLINTA',
    'APP_HAKULOMAKKEENHALLINTA_CRUD',
    'APP_HAKULOMAKKEENHALLINTA_CRUD_1.2.246.562.10.00000000001',
    'APP_HAKULOMAKKEENHALLINTA_LOMAKEPOHJANVAIHTO',
    'APP_HAKULOMAKKEENHALLINTA_LOMAKEPOHJANVAIHTO_1.2.246.562.10.00000000001',
    'APP_HAKUPERUSTEETADMIN',
    'APP_HAKUPERUSTEETADMIN_CRUD',
    'APP_HAKUPERUSTEETADMIN_CRUD_1.2.246.562.10.00000000001',
    'APP_HAKUPERUSTEETADMIN_REKISTERINPITAJA',
    'APP_HAKUPERUSTEETADMIN_REKISTERINPITAJA_1.2.246.562.10.00000000001',
    'APP_HENKILOTIETOMUUTOS',
    'APP_HENKILOTIETOMUUTOS_REKISTERINPITAJA',
    'APP_HENKILOTIETOMUUTOS_REKISTERINPITAJA_1.2.246.562.10.00000000001',
    'APP_IPOSTI',
    'APP_IPOSTI_READ',
    'APP_IPOSTI_READ_1.2.246.562.10.00000000001',
    'APP_IPOSTI_SEND',
    'APP_IPOSTI_SEND_1.2.246.562.10.00000000001',
    'APP_KAYTTOOIKEUS',
    'APP_KAYTTOOIKEUS_REKISTERINPITAJA',
    'APP_KAYTTOOIKEUS_REKISTERINPITAJA_1.2.246.562.10.00000000001',
    'APP_KAYTTOOIKEUS_VASTUUKAYTTAJAT',
    'APP_KAYTTOOIKEUS_VASTUUKAYTTAJAT_1.2.246.562.10.00000000001',
    'APP_KAYTTOOIKEUS_VIRKAILIJANLUONTI',
    'APP_KAYTTOOIKEUS_VIRKAILIJANLUONTI_1.2.246.562.10.00000000001',
    'APP_KOODISTO',
    'APP_KOODISTO_CRUD',
    'APP_KOODISTO_CRUD_1.2.246.562.10.00000000001',
    'APP_KOUTA',
    'APP_KOUTA_OPHPAAKAYTTAJA',
    'APP_KOUTA_OPHPAAKAYTTAJA_1.2.246.562.10.00000000001',
    'APP_LIITERI',
    'APP_LIITERI_CRUD',
    'APP_LIITERI_CRUD_1.2.246.562.10.00000000001',
    'APP_LOKALISOINTI',
    'APP_LOKALISOINTI_CRUD',
    'APP_LOKALISOINTI_CRUD_1.2.246.562.10.00000000001',
    'APP_OID',
    'APP_OID_CRUD',
    'APP_OID_CRUD_1.2.246.562.10.00000000001',
    'APP_OPPIJANTUNNISTUS',
    'APP_OPPIJANTUNNISTUS_CRUD',
    'APP_OPPIJANTUNNISTUS_CRUD_1.2.246.562.10.00000000001',
    'APP_OPPIJANUMEROREKISTERI',
    'APP_OPPIJANUMEROREKISTERI_REKISTERINPITAJA',
    'APP_OPPIJANUMEROREKISTERI_REKISTERINPITAJA_1.2.246.562.10.00000000001',
    'APP_ORGANISAATIOHALLINTA',
    'APP_ORGANISAATIOHALLINTA_CRUD',
    'APP_ORGANISAATIOHALLINTA_CRUD_1.2.246.562.10.00000000001',
    'APP_ORGANISAATIOHALLINTA_RYHMA',
    'APP_ORGANISAATIOHALLINTA_RYHMA_1.2.246.562.10.00000000001',
    'APP_OSOITE',
    'APP_OSOITE_CRUD',
    'APP_OSOITE_CRUD_1.2.246.562.10.00000000001',
    'APP_OTI',
    'APP_OTI_CRUD',
    'APP_OTI_CRUD_1.2.246.562.10.00000000001',
    'APP_PALAUTE',
    'APP_PALAUTE_PALAUTE_READ',
    'APP_PALAUTE_PALAUTE_READ_1.2.246.562.10.00000000001',
    'APP_RAPORTOINTI',
    'APP_RAPORTOINTI_CRUD',
    'APP_RAPORTOINTI_CRUD_1.2.246.562.10.00000000001',
    'APP_RAPORTOINTI_VALINTAKAYTTAJA',
    'APP_RAPORTOINTI_VALINTAKAYTTAJA_1.2.246.562.10.00000000001',
    'APP_RYHMASAHKOPOSTI',
    'APP_RYHMASAHKOPOSTI_SEND',
    'APP_RYHMASAHKOPOSTI_SEND_1.2.246.562.10.00000000001',
    'APP_RYHMASAHKOPOSTI_VIEW',
    'APP_RYHMASAHKOPOSTI_VIEW_1.2.246.562.10.00000000001',
    'APP_SIJOITTELU',
    'APP_SIJOITTELU_CRUD',
    'APP_SIJOITTELU_CRUD_1.2.246.562.10.00000000001',
    'APP_SISALLONHALLINTA',
    'APP_SISALLONHALLINTA_CRUD',
    'APP_SISALLONHALLINTA_CRUD_1.2.246.562.10.00000000001',
    'APP_SUORITUSREKISTERI',
    'APP_SUORITUSREKISTERI_CRUD',
    'APP_SUORITUSREKISTERI_CRUD_1.2.246.562.10.00000000001',
    'APP_TARJONTA',
    'APP_TARJONTA_CRUD',
    'APP_TARJONTA_CRUD_1.2.246.562.10.00000000001',
    'APP_TARJONTA_KK',
    'APP_TARJONTA_KK_READ',
    'APP_TARJONTA_KK_READ_1.2.246.562.10.00000000001',
    'APP_TIEDONSIIRTO',
    'APP_TIEDONSIIRTO_CRUD',
    'APP_TIEDONSIIRTO_CRUD_1.2.246.562.10.00000000001',
    'APP_TIEDONSIIRTO_VALINTA',
    'APP_TIEDONSIIRTO_VALINTA_1.2.246.562.10.00000000001',
    'APP_VALINTAPERUSTEET',
    'APP_VALINTAPERUSTEET_CRUD',
    'APP_VALINTAPERUSTEET_CRUD_1.2.246.562.10.00000000001',
    'APP_VALINTAPERUSTEKUVAUSTENHALLINTA',
    'APP_VALINTAPERUSTEKUVAUSTENHALLINTA_CRUD',
    'APP_VALINTAPERUSTEKUVAUSTENHALLINTA_CRUD_1.2.246.562.10.00000000001',
    'APP_VALINTAPERUSTEKUVAUSTENHALLINTA_KK',
    'APP_VALINTAPERUSTEKUVAUSTENHALLINTA_KK_CRUD',
    'APP_VALINTAPERUSTEKUVAUSTENHALLINTA_KK_CRUD_1.2.246.562.10.00000000001',
    'APP_VALINTATULOSSERVICE',
    'APP_VALINTATULOSSERVICE_CRUD',
    'APP_VALINTATULOSSERVICE_CRUD_1.2.246.562.10.00000000001',
    'APP_VALINTATULOSSERVICE_KELA_READ',
    'APP_VALINTATULOSSERVICE_KELA_READ_1.2.246.562.10.00000000001',
    'APP_VALINTOJENTOTEUTTAMINEN',
    'APP_VALINTOJENTOTEUTTAMINENKK',
    'APP_VALINTOJENTOTEUTTAMINENKK_CRUD',
    'APP_VALINTOJENTOTEUTTAMINENKK_CRUD_1.2.246.562.10.00000000001',
    'APP_VALINTOJENTOTEUTTAMINEN_CRUD',
    'APP_VALINTOJENTOTEUTTAMINEN_CRUD_1.2.246.562.10.00000000001',
    'APP_VALINTOJENTOTEUTTAMINEN_TULOSTENTUONTI',
    'APP_VALINTOJENTOTEUTTAMINEN_TULOSTENTUONTI_1.2.246.562.10.00000000001',
    'APP_VIRKAILIJANTYOPOYTA',
    'APP_VIRKAILIJANTYOPOYTA_CRUD',
    'APP_VIRKAILIJANTYOPOYTA_CRUD_1.2.246.562.10.00000000001',
    'APP_YHTEYSTIETOTYYPPIENHALLINTA',
    'APP_YHTEYSTIETOTYYPPIENHALLINTA_CRUD',
    'APP_YHTEYSTIETOTYYPPIENHALLINTA_CRUD_1.2.246.562.10.00000000001',
    'LANG_fi',
    'VIRKAILIJA',
  ],
  roles:
    '["APP_ASIAKIRJAPALVELU","APP_ASIAKIRJAPALVELU_ASIOINTITILICRUD","APP_ASIAKIRJAPALVELU_ASIOINTITILICRUD_1.2.246.562.10.00000000001","APP_ASIAKIRJAPALVELU_CREATE_LETTER","APP_ASIAKIRJAPALVELU_CREATE_LETTER_1.2.246.562.10.00000000001","APP_ASIAKIRJAPALVELU_CREATE_TEMPLATE","APP_ASIAKIRJAPALVELU_CREATE_TEMPLATE_1.2.246.562.10.00000000001","APP_ASIAKIRJAPALVELU_READ","APP_ASIAKIRJAPALVELU_READ_1.2.246.562.10.00000000001","APP_ASIAKIRJAPALVELU_SEND_LETTER_EMAIL","APP_ASIAKIRJAPALVELU_SEND_LETTER_EMAIL_1.2.246.562.10.00000000001","APP_ASIAKIRJAPALVELU_SYSTEM_ATTACHMENT_DOWNLOAD","APP_ASIAKIRJAPALVELU_SYSTEM_ATTACHMENT_DOWNLOAD_1.2.246.562.10.00000000001","APP_ATARU_EDITORI","APP_ATARU_EDITORI_CRUD","APP_ATARU_EDITORI_CRUD_1.2.246.562.10.00000000001","APP_ATARU_HAKEMUS","APP_ATARU_HAKEMUS_CRUD","APP_ATARU_HAKEMUS_CRUD_1.2.246.562.10.00000000001","APP_ATARU_HAKEMUS_VALINTA_CRUD","APP_ATARU_HAKEMUS_VALINTA_CRUD_1.2.246.562.10.00000000001","APP_EPERUSTEET","APP_EPERUSTEET_AMOSAA","APP_EPERUSTEET_AMOSAA_ADMIN","APP_EPERUSTEET_AMOSAA_ADMIN_1.2.246.562.10.00000000001","APP_EPERUSTEET_AMOSAA_CRUD","APP_EPERUSTEET_AMOSAA_CRUD_1.2.246.562.10.00000000001","APP_EPERUSTEET_CRUD","APP_EPERUSTEET_CRUD_1.2.246.562.10.00000000001","APP_EPERUSTEET_YLOPS","APP_EPERUSTEET_YLOPS_ADMIN","APP_EPERUSTEET_YLOPS_ADMIN_1.2.246.562.10.00000000001","APP_EPERUSTEET_YLOPS_CRUD","APP_EPERUSTEET_YLOPS_CRUD_1.2.246.562.10.00000000001","APP_HAKEMUS","APP_HAKEMUS_CRUD","APP_HAKEMUS_CRUD_1.2.246.562.10.00000000001","APP_HAKUJENHALLINTA","APP_HAKUJENHALLINTA_CRUD","APP_HAKUJENHALLINTA_CRUD_1.2.246.562.10.00000000001","APP_HAKULOMAKKEENHALLINTA","APP_HAKULOMAKKEENHALLINTA_CRUD","APP_HAKULOMAKKEENHALLINTA_CRUD_1.2.246.562.10.00000000001","APP_HAKULOMAKKEENHALLINTA_LOMAKEPOHJANVAIHTO","APP_HAKULOMAKKEENHALLINTA_LOMAKEPOHJANVAIHTO_1.2.246.562.10.00000000001","APP_HAKUPERUSTEETADMIN","APP_HAKUPERUSTEETADMIN_CRUD","APP_HAKUPERUSTEETADMIN_CRUD_1.2.246.562.10.00000000001","APP_HAKUPERUSTEETADMIN_REKISTERINPITAJA","APP_HAKUPERUSTEETADMIN_REKISTERINPITAJA_1.2.246.562.10.00000000001","APP_HENKILOTIETOMUUTOS","APP_HENKILOTIETOMUUTOS_REKISTERINPITAJA","APP_HENKILOTIETOMUUTOS_REKISTERINPITAJA_1.2.246.562.10.00000000001","APP_IPOSTI","APP_IPOSTI_READ","APP_IPOSTI_READ_1.2.246.562.10.00000000001","APP_IPOSTI_SEND","APP_IPOSTI_SEND_1.2.246.562.10.00000000001","APP_KAYTTOOIKEUS","APP_KAYTTOOIKEUS_REKISTERINPITAJA","APP_KAYTTOOIKEUS_REKISTERINPITAJA_1.2.246.562.10.00000000001","APP_KAYTTOOIKEUS_VASTUUKAYTTAJAT","APP_KAYTTOOIKEUS_VASTUUKAYTTAJAT_1.2.246.562.10.00000000001","APP_KAYTTOOIKEUS_VIRKAILIJANLUONTI","APP_KAYTTOOIKEUS_VIRKAILIJANLUONTI_1.2.246.562.10.00000000001","APP_KOODISTO","APP_KOODISTO_CRUD","APP_KOODISTO_CRUD_1.2.246.562.10.00000000001","APP_KOUTA","APP_KOUTA_OPHPAAKAYTTAJA","APP_KOUTA_OPHPAAKAYTTAJA_1.2.246.562.10.00000000001","APP_LIITERI","APP_LIITERI_CRUD","APP_LIITERI_CRUD_1.2.246.562.10.00000000001","APP_LOKALISOINTI","APP_LOKALISOINTI_CRUD","APP_LOKALISOINTI_CRUD_1.2.246.562.10.00000000001","APP_OID","APP_OID_CRUD","APP_OID_CRUD_1.2.246.562.10.00000000001","APP_OPPIJANTUNNISTUS","APP_OPPIJANTUNNISTUS_CRUD","APP_OPPIJANTUNNISTUS_CRUD_1.2.246.562.10.00000000001","APP_OPPIJANUMEROREKISTERI","APP_OPPIJANUMEROREKISTERI_REKISTERINPITAJA","APP_OPPIJANUMEROREKISTERI_REKISTERINPITAJA_1.2.246.562.10.00000000001","APP_ORGANISAATIOHALLINTA","APP_ORGANISAATIOHALLINTA_CRUD","APP_ORGANISAATIOHALLINTA_CRUD_1.2.246.562.10.00000000001","APP_ORGANISAATIOHALLINTA_RYHMA","APP_ORGANISAATIOHALLINTA_RYHMA_1.2.246.562.10.00000000001","APP_OSOITE","APP_OSOITE_CRUD","APP_OSOITE_CRUD_1.2.246.562.10.00000000001","APP_OTI","APP_OTI_CRUD","APP_OTI_CRUD_1.2.246.562.10.00000000001","APP_PALAUTE","APP_PALAUTE_PALAUTE_READ","APP_PALAUTE_PALAUTE_READ_1.2.246.562.10.00000000001","APP_RAPORTOINTI","APP_RAPORTOINTI_CRUD","APP_RAPORTOINTI_CRUD_1.2.246.562.10.00000000001","APP_RAPORTOINTI_VALINTAKAYTTAJA","APP_RAPORTOINTI_VALINTAKAYTTAJA_1.2.246.562.10.00000000001","APP_RYHMASAHKOPOSTI","APP_RYHMASAHKOPOSTI_SEND","APP_RYHMASAHKOPOSTI_SEND_1.2.246.562.10.00000000001","APP_RYHMASAHKOPOSTI_VIEW","APP_RYHMASAHKOPOSTI_VIEW_1.2.246.562.10.00000000001","APP_SIJOITTELU","APP_SIJOITTELU_CRUD","APP_SIJOITTELU_CRUD_1.2.246.562.10.00000000001","APP_SISALLONHALLINTA","APP_SISALLONHALLINTA_CRUD","APP_SISALLONHALLINTA_CRUD_1.2.246.562.10.00000000001","APP_SUORITUSREKISTERI","APP_SUORITUSREKISTERI_CRUD","APP_SUORITUSREKISTERI_CRUD_1.2.246.562.10.00000000001","APP_TARJONTA","APP_TARJONTA_CRUD","APP_TARJONTA_CRUD_1.2.246.562.10.00000000001","APP_TARJONTA_KK","APP_TARJONTA_KK_READ","APP_TARJONTA_KK_READ_1.2.246.562.10.00000000001","APP_TIEDONSIIRTO","APP_TIEDONSIIRTO_CRUD","APP_TIEDONSIIRTO_CRUD_1.2.246.562.10.00000000001","APP_TIEDONSIIRTO_VALINTA","APP_TIEDONSIIRTO_VALINTA_1.2.246.562.10.00000000001","APP_VALINTAPERUSTEET","APP_VALINTAPERUSTEET_CRUD","APP_VALINTAPERUSTEET_CRUD_1.2.246.562.10.00000000001","APP_VALINTAPERUSTEKUVAUSTENHALLINTA","APP_VALINTAPERUSTEKUVAUSTENHALLINTA_CRUD","APP_VALINTAPERUSTEKUVAUSTENHALLINTA_CRUD_1.2.246.562.10.00000000001","APP_VALINTAPERUSTEKUVAUSTENHALLINTA_KK","APP_VALINTAPERUSTEKUVAUSTENHALLINTA_KK_CRUD","APP_VALINTAPERUSTEKUVAUSTENHALLINTA_KK_CRUD_1.2.246.562.10.00000000001","APP_VALINTATULOSSERVICE","APP_VALINTATULOSSERVICE_CRUD","APP_VALINTATULOSSERVICE_CRUD_1.2.246.562.10.00000000001","APP_VALINTATULOSSERVICE_KELA_READ","APP_VALINTATULOSSERVICE_KELA_READ_1.2.246.562.10.00000000001","APP_VALINTOJENTOTEUTTAMINEN","APP_VALINTOJENTOTEUTTAMINENKK","APP_VALINTOJENTOTEUTTAMINENKK_CRUD","APP_VALINTOJENTOTEUTTAMINENKK_CRUD_1.2.246.562.10.00000000001","APP_VALINTOJENTOTEUTTAMINEN_CRUD","APP_VALINTOJENTOTEUTTAMINEN_CRUD_1.2.246.562.10.00000000001","APP_VALINTOJENTOTEUTTAMINEN_TULOSTENTUONTI","APP_VALINTOJENTOTEUTTAMINEN_TULOSTENTUONTI_1.2.246.562.10.00000000001","APP_VIRKAILIJANTYOPOYTA","APP_VIRKAILIJANTYOPOYTA_CRUD","APP_VIRKAILIJANTYOPOYTA_CRUD_1.2.246.562.10.00000000001","APP_YHTEYSTIETOTYYPPIENHALLINTA","APP_YHTEYSTIETOTYYPPIENHALLINTA_CRUD","APP_YHTEYSTIETOTYYPPIENHALLINTA_CRUD_1.2.246.562.10.00000000001","LANG_fi","USER_testuser","VIRKAILIJA"]',
  lang: 'fi',
};

const kayttooikeusUserDetailsFixture = {
  username: '1.2.246.562.24.26603962037',
  authorities: [
    {
      authority: 'ROLE_APP_VALINTOJENTOTEUTTAMINEN_CRUD',
    },
    {
      authority: 'ROLE_APP_ASIAKIRJAPALVELU_CREATE_TEMPLATE',
    },
    {
      authority: 'ROLE_APP_ASIAKIRJAPALVELU_READ_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_HAKEMUS_CRUD',
    },
    {
      authority:
        'ROLE_APP_KAYTTOOIKEUS_VIRKAILIJANLUONTI_1.2.246.562.10.00000000001',
    },
    {
      authority:
        'ROLE_APP_YHTEYSTIETOTYYPPIENHALLINTA_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_VALINTAPERUSTEET_CRUD',
    },
    {
      authority: 'ROLE_APP_ASIAKIRJAPALVELU_CREATE_LETTER',
    },
    {
      authority: 'ROLE_APP_VIRKAILIJANTYOPOYTA_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_SUORITUSREKISTERI_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority:
        'ROLE_APP_ATARU_HAKEMUS_VALINTA_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_SISALLONHALLINTA_CRUD',
    },
    {
      authority: 'ROLE_APP_HENKILOTIETOMUUTOS_REKISTERINPITAJA',
    },
    {
      authority: 'ROLE_APP_SIJOITTELU',
    },
    {
      authority: 'ROLE_APP_KOODISTO',
    },
    {
      authority: 'ROLE_APP_ORGANISAATIOHALLINTA_CRUD',
    },
    {
      authority: 'ROLE_APP_VIRKAILIJANTYOPOYTA_CRUD',
    },
    {
      authority: 'ROLE_APP_HAKUPERUSTEETADMIN',
    },
    {
      authority: 'ROLE_APP_RYHMASAHKOPOSTI_SEND',
    },
    {
      authority: 'ROLE_APP_TIEDONSIIRTO',
    },
    {
      authority: 'ROLE_APP_VALINTAPERUSTEET_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_ATARU_EDITORI_CRUD',
    },
    {
      authority: 'ROLE_APP_TIEDONSIIRTO_VALINTA_1.2.246.562.10.00000000001',
    },
    {
      authority:
        'ROLE_APP_ASIAKIRJAPALVELU_SYSTEM_ATTACHMENT_DOWNLOAD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_IPOSTI_READ',
    },
    {
      authority:
        'ROLE_APP_ORGANISAATIOHALLINTA_RYHMA_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_OSOITE_CRUD',
    },
    {
      authority:
        'ROLE_APP_ASIAKIRJAPALVELU_CREATE_LETTER_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_OTI',
    },
    {
      authority: 'ROLE_APP_KAYTTOOIKEUS_VASTUUKAYTTAJAT',
    },
    {
      authority: 'ROLE_APP_VALINTAPERUSTEET',
    },
    {
      authority: 'ROLE_APP_KOODISTO_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_RAPORTOINTI',
    },
    {
      authority: 'ROLE_APP_KAYTTOOIKEUS_REKISTERINPITAJA',
    },
    {
      authority: 'ROLE_APP_IPOSTI_READ_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_IPOSTI_SEND',
    },
    {
      authority: 'ROLE_APP_HENKILOTIETOMUUTOS',
    },
    {
      authority: 'ROLE_APP_OID_CRUD',
    },
    {
      authority: 'ROLE_APP_IPOSTI',
    },
    {
      authority:
        'ROLE_APP_RAPORTOINTI_VALINTAKAYTTAJA_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_ATARU_EDITORI_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET',
    },
    {
      authority: 'ROLE_APP_RYHMASAHKOPOSTI_VIEW',
    },
    {
      authority: 'ROLE_APP_YHTEYSTIETOTYYPPIENHALLINTA_CRUD',
    },
    {
      authority: 'ROLE_APP_HAKUJENHALLINTA',
    },
    {
      authority: 'ROLE_APP_SIJOITTELU_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority:
        'ROLE_APP_ASIAKIRJAPALVELU_ASIOINTITILICRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_AMOSAA_ADMIN_1.2.246.562.10.00000000001',
    },
    {
      authority:
        'ROLE_APP_VALINTOJENTOTEUTTAMINEN_TULOSTENTUONTI_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_RYHMASAHKOPOSTI_VIEW_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_YLOPS_ADMIN_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_HAKULOMAKKEENHALLINTA',
    },
    {
      authority:
        'ROLE_APP_HENKILOTIETOMUUTOS_REKISTERINPITAJA_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_TARJONTA',
    },
    {
      authority:
        'ROLE_APP_VALINTATULOSSERVICE_KELA_READ_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_ASIAKIRJAPALVELU_ASIOINTITILICRUD',
    },
    {
      authority: 'ROLE_APP_ATARU_EDITORI',
    },
    {
      authority:
        'ROLE_APP_HAKUPERUSTEETADMIN_REKISTERINPITAJA_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_ASIAKIRJAPALVELU_READ',
    },
    {
      authority: 'ROLE_APP_TIEDONSIIRTO_VALINTA',
    },
    {
      authority: 'ROLE_APP_VALINTATULOSSERVICE',
    },
    {
      authority:
        'ROLE_APP_VALINTOJENTOTEUTTAMINEN_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_VALINTOJENTOTEUTTAMINENKK',
    },
    {
      authority: 'ROLE_APP_PALAUTE_PALAUTE_READ',
    },
    {
      authority:
        'ROLE_APP_ASIAKIRJAPALVELU_SEND_LETTER_EMAIL_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_OTI_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_HAKEMUS',
    },
    {
      authority: 'ROLE_APP_SISALLONHALLINTA',
    },
    {
      authority:
        'ROLE_APP_KAYTTOOIKEUS_REKISTERINPITAJA_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_YHTEYSTIETOTYYPPIENHALLINTA',
    },
    {
      authority: 'ROLE_APP_RYHMASAHKOPOSTI_SEND_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_KAYTTOOIKEUS_VIRKAILIJANLUONTI',
    },
    {
      authority:
        'ROLE_APP_VALINTAPERUSTEKUVAUSTENHALLINTA_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_RAPORTOINTI_VALINTAKAYTTAJA',
    },
    {
      authority: 'ROLE_APP_HAKULOMAKKEENHALLINTA_LOMAKEPOHJANVAIHTO',
    },
    {
      authority: 'ROLE_APP_VALINTOJENTOTEUTTAMINENKK_CRUD',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_CRUD',
    },
    {
      authority: 'ROLE_APP_HAKEMUS_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_HAKUJENHALLINTA_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_OPPIJANTUNNISTUS_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority:
        'ROLE_APP_ASIAKIRJAPALVELU_CREATE_TEMPLATE_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_TIEDONSIIRTO_CRUD',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_YLOPS_CRUD',
    },
    {
      authority: 'ROLE_APP_OPPIJANTUNNISTUS',
    },
    {
      authority: 'ROLE_APP_SUORITUSREKISTERI',
    },
    {
      authority: 'ROLE_APP_ATARU_HAKEMUS',
    },
    {
      authority: 'ROLE_APP_SIJOITTELU_CRUD',
    },
    {
      authority: 'ROLE_APP_OID',
    },
    {
      authority: 'ROLE_APP_KOUTA',
    },
    {
      authority: 'ROLE_APP_HAKUPERUSTEETADMIN_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority:
        'ROLE_APP_OPPIJANUMEROREKISTERI_REKISTERINPITAJA_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_SUORITUSREKISTERI_CRUD',
    },
    {
      authority: 'ROLE_APP_VALINTOJENTOTEUTTAMINEN_TULOSTENTUONTI',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_AMOSAA_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_OPPIJANUMEROREKISTERI',
    },
    {
      authority:
        'ROLE_APP_HAKULOMAKKEENHALLINTA_LOMAKEPOHJANVAIHTO_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_KOODISTO_CRUD',
    },
    {
      authority: 'ROLE_APP_OID_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_VALINTOJENTOTEUTTAMINEN',
    },
    {
      authority: 'ROLE_APP_ASIAKIRJAPALVELU_SYSTEM_ATTACHMENT_DOWNLOAD',
    },
    {
      authority: 'ROLE_APP_LOKALISOINTI',
    },
    {
      authority: 'ROLE_APP_LOKALISOINTI_CRUD',
    },
    {
      authority: 'ROLE_APP_ASIAKIRJAPALVELU',
    },
    {
      authority: 'ROLE_APP_OSOITE_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_OTI_CRUD',
    },
    {
      authority: 'ROLE_APP_HAKUPERUSTEETADMIN_REKISTERINPITAJA',
    },
    {
      authority: 'ROLE_APP_OPPIJANUMEROREKISTERI_REKISTERINPITAJA',
    },
    {
      authority: 'ROLE_APP_VALINTAPERUSTEKUVAUSTENHALLINTA_KK',
    },
    {
      authority: 'ROLE_APP_TARJONTA_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_TARJONTA_KK_READ',
    },
    {
      authority: 'ROLE_APP_PALAUTE_PALAUTE_READ_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_OSOITE',
    },
    {
      authority: 'ROLE_APP_VALINTATULOSSERVICE_CRUD',
    },
    {
      authority:
        'ROLE_APP_KAYTTOOIKEUS_VASTUUKAYTTAJAT_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_SISALLONHALLINTA_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_TARJONTA_KK_READ_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_VALINTAPERUSTEKUVAUSTENHALLINTA_CRUD',
    },
    {
      authority: 'ROLE_APP_ATARU_HAKEMUS_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_RAPORTOINTI_CRUD',
    },
    {
      authority: 'ROLE_APP_ASIAKIRJAPALVELU_SEND_LETTER_EMAIL',
    },
    {
      authority: 'ROLE_APP_PALAUTE',
    },
    {
      authority: 'ROLE_APP_HAKUPERUSTEETADMIN_CRUD',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_AMOSAA_CRUD',
    },
    {
      authority:
        'ROLE_APP_HAKULOMAKKEENHALLINTA_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_YLOPS_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority:
        'ROLE_APP_VALINTAPERUSTEKUVAUSTENHALLINTA_KK_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_VALINTAPERUSTEKUVAUSTENHALLINTA_KK_CRUD',
    },
    {
      authority: 'ROLE_APP_VIRKAILIJANTYOPOYTA',
    },
    {
      authority: 'ROLE_APP_KAYTTOOIKEUS',
    },
    {
      authority: 'ROLE_APP_LOKALISOINTI_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_AMOSAA_ADMIN',
    },
    {
      authority: 'ROLE_APP_RYHMASAHKOPOSTI',
    },
    {
      authority:
        'ROLE_APP_VALINTOJENTOTEUTTAMINENKK_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_HAKUJENHALLINTA_CRUD',
    },
    {
      authority: 'ROLE_APP_ORGANISAATIOHALLINTA_RYHMA',
    },
    {
      authority: 'ROLE_APP_ATARU_HAKEMUS_CRUD',
    },
    {
      authority: 'ROLE_APP_LIITERI',
    },
    {
      authority: 'ROLE_APP_TARJONTA_CRUD',
    },
    {
      authority: 'ROLE_APP_ATARU_HAKEMUS_VALINTA_CRUD',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_AMOSAA',
    },
    {
      authority: 'ROLE_APP_KOUTA_OPHPAAKAYTTAJA',
    },
    {
      authority:
        'ROLE_APP_ORGANISAATIOHALLINTA_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_YLOPS_ADMIN',
    },
    {
      authority: 'ROLE_APP_OPPIJANTUNNISTUS_CRUD',
    },
    {
      authority: 'ROLE_APP_VALINTATULOSSERVICE_KELA_READ',
    },
    {
      authority: 'ROLE_APP_HAKULOMAKKEENHALLINTA_CRUD',
    },
    {
      authority: 'ROLE_APP_LIITERI_CRUD',
    },
    {
      authority: 'ROLE_APP_TIEDONSIIRTO_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_IPOSTI_SEND_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_RAPORTOINTI_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_KOUTA_OPHPAAKAYTTAJA_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_ORGANISAATIOHALLINTA',
    },
    {
      authority: 'ROLE_APP_VALINTAPERUSTEKUVAUSTENHALLINTA',
    },
    {
      authority: 'ROLE_APP_TARJONTA_KK',
    },
    {
      authority: 'ROLE_APP_VALINTATULOSSERVICE_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_LIITERI_CRUD_1.2.246.562.10.00000000001',
    },
    {
      authority: 'ROLE_APP_EPERUSTEET_YLOPS',
    },
  ],
  accountNonExpired: true,
  accountNonLocked: true,
  credentialsNonExpired: true,
  enabled: true,
  password: null,
};

module.exports = function (app) {
  app.use('*', function (req, res, next) {
    if (
      ['/', '/kouta'].includes(req.originalUrl) ||
      req.originalUrl.startsWith('/kouta/')
    ) {
      next();
    } else {
      if (DISABLE_LOCAL_PROXY) {
        res.sendStatus(404);
      } else if (
        KOUTA_BACKEND_URL &&
        req.originalUrl.startsWith('/kouta-backend')
      ) {
        koutaBackendProxyMiddleware(req, res, next);
      } else if (
        req.originalUrl.startsWith('/kayttooikeus-service/userDetails')
      ) {
        res.send(kayttooikeusUserDetailsFixture);
      } else if (req.originalUrl.startsWith('/kayttooikeus-service/cas/me')) {
        res.send(kayttooikeusMeFixture);
      } else if (
        req.originalUrl.startsWith(
          '/ohjausparametrit-service/j_spring_cas_security_check'
        )
      ) {
        res.cookie('JSESSIONID', 'adsf');
        res.send(ohjausparametritFixture);
      } else if (
        req.originalUrl.startsWith(
          '/ohjausparametrit-service/api/v1/rest/parametri'
        )
      ) {
        res.sendStatus(200);
      } else if (req.originalUrl.startsWith('/cas/')) {
        casProxyMiddleware(req, res, next);
      } else {
        devProxyMiddleware(req, res, next);
      }
    }
  });
};
